# -*- coding:utf-8 -*-

"""
@date: 2025/4/21 下午2:24
@summary: pgvector 测试
"""
import psycopg2
import numpy as np
from psycopg2.extras import RealDictCursor
from postgresql_client.postgresql_conn import PostgresqlConn
from postgresql_client.pool_wrapper import PoolWrapper

class TestConn(PostgresqlConn):
    pool = PoolWrapper(creator=psycopg2,
                       maxcached=5,
                       mincached=1,
                       maxconnections=10,
                       host='10.105.11.252',
                       user='username',
                       password='password',
                       database='postgres',
                       port='5432',
                       cursor_factory=RealDictCursor
                       )

    """docstring for Base_MysqlConn"""

    def __init__(self):
        super(TestConn, self).__init__()



def t():
    with TestConn() as conn:
        emb = [0.04412514,0.016754534,0.046617348,-0.048060577,0.0022115149,0.056468982,0.062217847,0.04455137,-0.015911262,0.03552714,-0.01378846,0.030691335,0.038999625,0.0055535296,-0.00320063,0.06523521,-0.028528495,0.027944202,-0.02902955,0.010974112,0.011927091,0.052368917,-0.0009403444,-0.007702774,0.002252537,0.04450539,0.004204519,0.020797113,0.019483052,0.031174181,-0.00079587474,0.0056259306,0.043106038,0.0037477168,0.0175411,0.029930433,0.01131347,0.01667347,0.011600428,0.05640266,0.059607703,-0.012874773,-0.028613558,-0.037316464,-0.032470282,-0.0026604647,0.0031671845,-0.028646577,-0.026896462,0.043161,0.012794275,-0.03398836,-0.04425678,0.057049178,0.064632975,0.038998947,-0.00047199946,0.0055387015,0.008398207,0.049817223,0.006573395,-0.0791138,0.009841324,0.057059612,0.03671104,0.06514337,-0.033730157,0.026341358,0.017857116,0.017957756,0.034335498,0.03540816,0.018617023,-0.0019545713,-0.022459341,0.003252646,0.008204512,0.033671964,-0.043720774,-0.030760149,0.010977507,0.008830379,0.015429493,0.0117634265,0.012249227,-0.04016997,-0.021191994,-0.034146838,0.021378616,0.021485312,-0.010365308,0.0330598,0.0064527174,0.0025118527,0.015981508,0.011017545,-0.0142315645,-0.0032493153,0.03046905,-0.0153263835,-0.033050902,0.035342768,-0.04180127,0.018609874,-0.0550689,0.022240752,0.021334711,-0.020392828,-0.038446892,0.03777279,0.0047650286,-0.046453074,-0.00046024108,-0.039423205,-0.038339704,-0.035361275,-0.006573604,-0.015394576,0.008977051,-0.020877535,-0.014169694,-0.02629303,-0.02626041,0.040388778,-0.029704815,0.012481933,0.013533954,-0.026683245,-0.036415495,0.0038239537,-0.033476435,0.021428734,-0.020103658,0.0043486855,0.012489606,0.04681395,0.019135635,0.045586277,-0.019431071,0.015341396,0.029143985,-0.0034817148,-0.03530403,0.041429937,-0.015546523,0.006108338,0.048058834,0.039811432,-0.00022991911,-0.007926541,0.0086703785,0.031268578,0.014223448,0.028249726,0.002833551,-0.0303644,0.028170792,0.0069679795,-0.005666232,0.043534737,0.012143664,0.04504523,-0.02407284,-0.009623152,-0.022793055,-0.016029269,0.0063926214,-0.035316076,0.016263612,-0.028325262,-0.009567109,-0.0017238106,-0.011409811,-0.0011867196,0.0019756593,-0.03738744,-0.034960475,0.023815056,-0.0036459556,-0.06754564,0.023726908,-0.0066482257,-0.007934181,-0.017537352,-0.041090433,-0.04192534,0.0064854827,0.017121755,-0.0035204927,-0.012497477,0.046392515,-0.0038765687,0.01380748,0.015027781,0.0038194256,0.0005184976,0.028453091,-0.012586013,-0.009490038,-0.01271005,-0.018873088,-0.06338781,-0.028292745,-0.0046465755,-0.005689287,-0.01894195,-0.011819984,0.0004879148,-0.0041986243,0.012508528,0.010687467,0.025004266,0.007540635,-0.025185216,-0.017453035,0.016239107,-0.0444561,-0.007999616,0.062035862,0.004058465,0.051168777,-0.006579872,-0.009802181,-0.023091871,-0.014152194,0.06568486,0.016310355,-0.011689781,0.001992452,0.0457124,-0.013027275,0.005295223,-0.007946906,0.0134314755,-0.022134956,0.0020555258,-0.013392631,0.032760523,0.0069670407,0.0067373724,-0.024821224,-0.004154818,0.008676774,-0.002251459,0.062389754,-0.003992774,-0.0022243701,-0.04295732,-0.050029818,-0.050555125,0.030511815,0.048997913,-0.058874093,0.026228957,-0.02778412,0.020830018,0.023272086,-0.008995603,-0.012352368,-0.01302945,-0.019872524,-0.013856155,0.0055906614,-0.057448138,0.016103936,0.030802172,-0.004996809,0.0230715,-0.0073999595,-0.010257378,-0.0012067211,-0.019091193,-0.0072597414,-0.019000048,0.03442324,-0.02938927,-0.011184684,0.025351139,-0.0025178115,-0.033168133,-0.030257117,0.016850514,0.02220719,0.032290466,-0.03780174,0.01150591,-0.018975316,-0.010170997,-0.02950116,0.0213595,0.007042567,0.008117663,-0.023882857,0.012139822,0.04123597,0.047791682,-0.0046700556,-0.025009137,0.027117215,0.044422034,0.050433915,-0.010153217,-0.0016398827,0.026966147,-0.03455065,0.006906676,-7.066263e-05,-0.049086157,0.045744188,0.03739089,0.049971763,-0.0216147,0.017691726,0.013588345,-0.012171073,-0.0026411342,0.0132893305,0.03717515,0.00346053,-0.032079753,-0.003843555,-0.047298085,0.0109271305,0.019965392,-0.0053510386,0.0472175,-0.02258973,-0.0018231104,-0.03505843,0.067704566,0.010809593,-0.030627603,0.05107014,-0.009004072,0.006237832,0.005727104,-0.022538992,0.011964138,-0.010557765,0.019254321,0.02912277,0.00065169274,0.0122250775,-0.02592517,0.005710231,0.024391998,0.020756852,-0.041266266,-0.06993937,-0.005585341,-0.011165461,-0.017727198,-0.015630603,0.0031031098,0.017426891,-0.03191489,0.032821212,-0.06813293,0.018479286,-0.019746315,-0.036812212,-0.053095523,-0.05937358,-0.030940186,-0.0007342149,0.0076247077,-0.023590904,-0.004087676,-0.01489941,0.032844204,-0.011634511,-0.035058446,-0.033227954,-0.0065953913,0.0377044,-0.09632594,-0.03152054,-0.053177394,-0.014569754,-0.044942595,0.0040972135,0.06936184,-0.06453454,-0.008872355,-0.023770692,-0.047469404,-0.007364296,0.034312196,-0.05699645,-0.09304013,0.007930722,-0.023003975,0.02397055,-0.03192638,-0.021088267,-0.029604094,-0.019468907,-0.017930785,-0.021024777,-0.0032297105,0.03644074,0.029108776,0.0077244607,-0.011558181,0.028102813,0.018639024,0.028305816,0.03890318,0.0455046,0.0465826,-0.004774587,0.033372242,0.00035674154,0.010807283,-0.04162827,-0.03596483,0.0056028785,-0.019542424,0.035089273,0.09002585,-0.01150643,0.0014997713,-0.0072549214,0.025232118,0.011624383,-0.046648033,-0.017462496,-0.031070648,-0.054845743,0.030122953,0.008045748,0.04764464,0.018013824,0.0371664,0.035004146,0.033696484,-0.07067979,0.0055289012,-0.010273172,0.01686524,0.02241848,0.029125916,-0.019252587,-0.01897464,-0.02515829,-0.026121939,-0.023431081,-0.005716916,0.026558256,-0.008967303,-0.03520853,0.062064793,0.04100855,-0.026975939,0.017389407,-0.012977899,0.041923504,-0.0024224527,0.03444088,0.02094407,-0.023839667,-0.0064786198,0.038232926,-0.046946093,0.0003609829,0.018124674,-0.025174161,-0.06580203,-0.027866568,-0.05917767,-0.031952564,0.012668065,0.032619007,-0.01979814,0.0073700706,-0.0043339827,-0.022068841,0.011725942,0.014457853,-0.041863646,-0.029314494,0.0048865885,0.013798675,0.05093373,0.03781903,-0.07145078,-0.022680512,-0.028666597,-0.030505233,0.027149726,0.019553835,-0.03420166,-0.049902905,-0.019915693,0.0064800857,-0.025248729,-0.02063569,-0.023805229,-0.019528177,0.00535411,-0.04426222,0.05282782,0.0312543,0.011266595,-0.03309,0.01741218,0.0016554312,-0.014583617,0.0069062845,0.035393942,0.053459834,0.03259466,0.011079013,0.019298691,-0.0060718446,-0.006307993,-0.018582797,-0.040332668,-0.049711827,-0.030741338,2.0936475e-05,0.041086953,-0.053944852,0.045170613,-0.0031640998,0.0020677848,0.0016354349,0.007870324,0.018492213,0.0016834391,-0.012984527,-0.002906706,-0.0027439066,0.052589472,-0.08575028,-0.00745042,-0.07207111,0.042608224,0.009450564,-0.008038982,-0.03597091,-0.050229706,-0.006105619,-0.021161538,-0.023853313,-0.024898965,0.01872976,0.014256962,0.00016647665,0.07569852,0.008793464,-0.0042434675,-0.007568198,-0.00079952227,-0.012287585,0.03236873,0.037834447,-0.03213612,0.02308242,0.026200444,0.008578636,-0.0047563748,-0.03234138,9.464263e-06,0.03315535,0.0032670877,-0.015287469,0.0088912845,0.052131552,-0.0036543114,-0.016129456,-0.011313521,-0.0012393384,0.055600855,-0.007923658,0.02777414,-0.013463235,-0.04535703,-0.027480837,0.050119538,-0.015422086,0.012793917,-0.010655081,0.018068679,0.0049083247,-0.015304692,-0.012847584,0.026726441,0.018158881,0.0065044663,-0.0018717953,0.008521713,-0.013270863,-0.024376096,-0.0532069,0.032379285,-0.065284856,-0.00870241,-0.016561758,0.062658325,0.040226072,-0.020368738,0.010040885,0.057128575,-0.020935003,-0.021194533,-0.038220067,-0.029960249,0.051540375,0.025442608,-0.010033873,0.038280793,-0.06126049,-0.010682029,-0.0550271,-0.012992266,0.012811502,-0.039238114,0.0053381184,0.017656336,-0.051737085,-0.0058610956,0.0050099827,-0.042740382,0.051637355,0.0038509162,-0.016180376,-0.00049538113,-0.0305971,0.018641172,-0.020121902,-0.06393226,-0.008990209,0.027539654,-0.008158347,-0.001893075,-0.03131319,0.010108317,0.014994322,0.012090775,-0.04316877,0.0014928147,-0.050003838,0.04526623,0.02806329,0.008663302,-0.041394174,-0.014778407,-0.03267279,0.017317979,0.009103586,0.016035285,-0.055205353,-0.0217167,0.024568142,-0.006322053,-0.015367061,-0.020866483,0.004565513,0.0324141,0.07475646,0.0652582,0.00095116504,0.051705174,-0.0127015095,0.012621666,-0.026312364,-0.036165074,-0.0011777413,0.010447194,-0.042687673,-0.041483164,-0.031433087,0.05409749,-0.013391258,0.00014180665,-0.0009069309,-0.020440284,0.04172185,0.021217564,-0.0309,-0.009882369,0.019900342,-0.011056765,0.003783398,-0.009818684,-0.009604477,0.015986154,0.022753168,0.057767197,-0.012735748,-0.013992718,-0.009616935,-0.0032477095,0.03125436,0.03298448,0.024563871,-0.0037565879,-0.025860075,-0.012363744,-0.019232474,0.01190467,-0.07378561,0.05880521,0.036322277,-0.030491307,-0.016996259,-0.008227992,-0.010805124,-0.028256223,0.034919225,0.03448905,0.082309045,-0.06051155,-0.014694616,-0.038418755,-0.02773863,-0.0031284587,0.030645177,-0.03552425,0.0010628531,-0.004610052,0.054482274,-0.0019091101,-0.019914743,0.006202097,0.007058923,-0.021308633,-0.00089213066,0.07120267,0.0023639367,-0.019903922,0.019392498,-0.023960643,0.015168632,-0.017770926,-0.049747016,0.011807763,0.018602047,-0.086830124,0.022361651,0.017918551,0.012322187,-0.041701443,-0.00979254,0.010996145,0.016221527,-0.0022034058,0.039228667,-0.008232676,-0.008554421,0.036909595,0.0051047914,-0.007873164,-0.026043603,-0.031643145,-0.0033871748,-0.005918412,0.01224214,0.023746232,-0.039494812,0.036502004,-0.022882571,-0.038905527,-0.007931101,-0.022996554,-0.0030233937,-0.00884916,0.04048084,-0.00015286307,0.015693257,0.015701436,0.02232828,0.061973065,0.034517083,0.010983238,0.015249387,0.007691078,-0.016470248,-0.026230171,0.026653726,-0.016727276,-0.024252167,-0.010437735,-0.009866344,0.003862973,0.05633779,0.0044279364,0.042378165,0.009298242,0.008151614,-0.057601,-0.005458626,0.045335487,0.02418939,-0.02903197,-0.0070294826,-0.0099389935,-0.04569169,0.008780849,-0.037238583,-0.008739194,-0.03100245,0.019978708,0.06604006,-0.03500161,-0.0026098634,0.036741145,-0.004042995,-0.030563219,0.017301042,-0.0021592693,0.045255613,0.014148523,-0.0024797649,0.01891929,0.016556798,-0.03669587,0.011884755,0.00038661898,-0.0045669684,0.016958056,-0.0106433695,0.0070206462,0.019435083,-0.058242828,-0.008392191,0.05088764,0.032152336,0.04917377,-0.029245785,-0.027800888,-0.008782211,-0.045801513,-0.021101203,-0.031695787,-0.034421574,0.020496592,-0.030880546,-0.051136322,0.03771938,-0.0008925134,-0.0012616841,-0.038960423,-0.014250628,0.02747492,0.039806675,-0.003305686,0.00047446776,0.019309549,-0.04265099,0.015832884,-0.055708054,-0.03734899,-0.003321427,-0.008500952,-0.01831507,-0.033498727,-0.03887329,0.0033896484,0.038547188,0.052990813,-0.0994245,0.0061063976,-0.0075064683,0.03368845,-0.032666616,0.036223426,-0.03341069,0.0028194543,-0.025569309,-0.023363952,0.05331269,-0.016698835,-0.039020803,-0.055229448,0.05843859,-0.07010355,0.022084747,0.03463897,-0.007284451,-0.009323146,-0.02615393,-0.0016845342,0.02950596,-0.013361966,-0.04641296,0.05050117,0.021281144,0.0021899245,0.034726482,-0.009507722,0.042892933,-0.0060628443,0.026604505,0.004050872,0.0027888757,-0.0061074896,0.053188793,-0.016860252,-0.027153185,0.051812787,0.0059255124,0.0007274529,0.0065044058,0.023292663,0.006014808,-0.0043682223,0.05148955,-0.007053213,0.01577937,-0.032213304,-0.024712538,0.011508831,0.03304474,-0.075355,0.040992353,0.034659397,0.02754134,0.032340568,-0.0023253392,0.028908243,0.037405293,0.020905077,0.044881567,0.030397715,0.008899709,0.008270894,-0.014946527,-0.020077206,0.024865944,-0.02031832,-0.015822439,-0.017623736,0.014255927,0.007516633,0.0073772697,-0.022297077,0.00032331687,-0.036295347,-0.011076964,-0.0023786994,-0.029044658,0.015913283,-0.046987593,0.019029928,0.004701179,-0.029054662,-0.04410028,0.015346709,0.022088377,0.03251998,-0.031292338,-0.057375085,-0.042335,0.020129096,0.011621021,-0.025571432,-0.017784595,-0.024024505,-0.007012649,0.030599782,0.025870819,0.011895073,-0.018833548,-0.05696882,-0.025954176,0.031271547,-0.03819509,0.01966949,0.021883374,-0.0058364165,0.047274854,-0.007951989,-0.008264449,-0.02266547,-0.031687725,0.035732135,-0.005357966,-0.041531987,-0.0058109355,0.03293867,0.0038200645,-0.045855686,-0.015725782,0.01739611,0.06023212,-0.021757174,-0.018481093,-0.017791761,0.011524793,-0.014255789,0.0359068,0.007509119,-0.00029898505,-0.0074009476,0.032361813,-0.004807338,0.05352594,0.036944203,-0.0045152875,0.041623414,-0.011321383,0.02947876,-0.008995824,0.056280836,-0.03046694,0.06712043,0.019319167,-0.0088886395,-0.010293741,-0.06028043,0.0055370494,-0.0022269005,0.02371068,-0.025432266,-0.0090316525,0.054543074,-0.003808475,0.04878677,-0.019690976,0.033029955,0.04074972,0.037518628,-0.04584052,0.006361779,0.017700836,-0.018248837,0.00083972304,0.021441549,0.023624424,0.016916374,-0.006041585,0.01348983,-0.005235546,0.0116536515,0.014808349,0.0021087024,-0.001215295,0.024770131,-0.010832409,0.010610552,-0.011022664,0.004166924,0.004528775,0.019884735,-0.0003570534,-0.002924781,0.00085529947,0.016898915,0.0015964765,0.007896766,0.0073978105,0.01183699,-0.00030219756,0.0021361934,0.016367575,0.0014230266,0.0066604423,0.011364733,0.0042957803,0.006330999,0.00440474,0.021416368,0.022633338,-0.0048886146,-0.010864709,-0.014169245,-0.012329126,-0.0010101915,0.0012025955,-0.010877246,-0.0102127185,0.016388446,0.004858049,-0.012905547,-0.016804518,0.021661853,0.024541458,0.014808091,-0.00017922053,0.0021030724,0.0031888408,0.018915845,0.0024959503,-0.030039899,0.003736799,0.021665817,0.013939364,0.024735257,-0.012807506,0.0100019425,0.0067804344,0.006818649,0.013037358,0.013444654,0.0070689754,-0.0007421604,-0.008527922,0.0012350457,0.0031152936,0.012785411,-0.016600993,-0.01167978,0.0041682133,0.0033529382,0.005858654,0.004466631,0.004651092,-0.015252735,-0.008046703,-0.012965723,0.008117566,0.008158078,-0.0039357585,0.012552967,0.0024501283,0.0009537628,0.0060682576,0.0041834163,-0.0054037953,-0.0012337811,0.011569248,-0.0058195037,-0.01254959,0.013419824,-0.015872149,0.007066261,-0.020909932,0.008444923,0.008100895,-0.007743257,-0.014598475,0.014342514,0.0018093047,-0.017638462,-0.0001747558,-0.014969186,-0.014557774,-0.013426851,-0.0024960297,-0.005845396,0.0034086301,-0.007927303,-0.0053803027,-0.009983593,-0.009971207,0.015335818,-0.011279063,0.0047394517,0.005138909,-0.01013176,-0.013827142,0.001451974,-0.012711166,0.0081365965,-0.007633458,0.0016512172,0.0047423644,0.017775487,0.0072658947,0.017309334,-0.0073780734,0.005825204,0.011066114,-0.0013220242,-0.0134051135,0.01573115,-0.0059030913,0.002319366,0.018248174,0.015116597,-8.730142e-05,-0.0030097468,0.003292185,0.011872834,0.0054007135,0.01072656,0.0010759133,-0.011529513,0.010696589,0.002645776,-0.0021514962,0.016530354,0.004611009,0.017103896,-0.009140576,-0.0036539582,-0.008654635,-0.006086392,0.0024273098,-0.013409688,0.0061753737,-0.010755241,-0.0036326784,-0.0006545393,-0.0043323613,-0.0004506033,0.0007501675,-0.014196196,-0.013274665,0.009042693,-0.0013843873,-0.02564741,0.009009224,-0.0025243638,-0.0030126476,-0.006659019,-0.015602239,-0.015919259,0.0024625696,0.006501214,-0.0013367484,-0.0047453535,0.017615465,-0.0014719523,0.005242768,0.005706122,0.0014502547,0.00019687609,0.010803779,-0.004778971,-0.003603414,-0.0048260684,-0.0071662045,-0.024068665,-0.010742895,-0.0017643278,-0.0021602504,-0.0071923523,-0.004488106,0.00018526366,-0.0015942383,0.00474955,0.0040580835,0.009494243,0.0028632162,-0.009562951,-0.0066270027,0.0061660684,-0.0168802,-0.0030374934,0.023555323,0.0015410191,0.019429037,-0.0024984097,-0.0037219368,-0.0087680975,-0.005373658,0.024940867,0.006193122,-0.004438667,0.0007565438,0.017357223,-0.00494652,0.0020106223,-0.0030174793,0.005099998,-0.008404751,0.00078049325,-0.005085248,0.012439332,0.0026454197,0.0025582134,-0.00942474,-0.0015776049,0.0032946137,-0.0008548901,0.023689697,-0.001516076,-0.00084460434,-0.016311105,-0.018996568,-0.01919603,0.011585486,0.018604748,-0.022354783,0.009959265,-0.010549767,0.00790926,0.0088365255,-0.003415675,-0.0046902546,-0.004947346,-0.007545695,-0.0052612503,0.0021228015,-0.02181334,0.0061147436,0.011695737,-0.001897313,0.008760362,-0.002809801,-0.003894777,-0.00045819793,-0.00724902,-0.0027565595,-0.0072144116,0.013070674,-0.01115925,-0.0042468794,0.009625953,-0.0009560255,-0.012594103,-0.011488776,0.006398223,0.008432179,0.01226085,-0.014353506,0.004368851,-0.0072050206,-0.0038619777,-0.011201736,0.008110307,0.0026740972,0.0030823166,-0.009068438,0.004609551,0.0156575,0.018146737,-0.0017732432,-0.009496092,0.01029654,0.016867265,0.019150008,-0.0038552268,-0.0006226715,0.010239179,-0.01311905,0.002622499,-2.6830949e-05,-0.018638255,0.017369293,0.014197505,0.018974524,-0.0082072085,0.0067176353,0.0051595615,-0.0046214163,-0.0010028518,0.005046024,0.014115587,0.0013139802,-0.012180839,-0.0014594167,-0.017959317,0.0041490854,0.007580957,-0.0020318157,0.017928718,-0.008577432,-0.00069224404,-0.013311859,0.025707757,0.004104456,-0.011629451,0.019391583,-0.0034188903,0.0023685354,0.0021746096,-0.008558165,0.0045428416,-0.0040088356,0.007310961,0.0110580595,0.00024745092,0.004641922,-0.009843915,0.0021682028,0.009261761,0.007881478,-0.015669005,-0.026556322,-0.0021207815,-0.00423958,-0.006731104,-0.0059350166,0.0011782661,0.006617076,-0.012118241,0.012462377,-0.025870407,0.0070166755,-0.007497773,-0.013977778,-0.020160632,-0.02254444,-0.011748141,-0.000278785,0.002895139,-0.0089575825,-0.0015521107,-0.0056573795,0.012471107,-0.004417681,-0.013311865,-0.012616818,-0.0025043027,0.014316548,-0.036575437,-0.011968505,-0.020191718,-0.0055322074,-0.017064925,0.0015557321,0.026337031,-0.024504082,-0.003368877,-0.0090258485,-0.018024366,-0.0027962595,0.013028509,-0.021641834,-0.035327796,0.0030113342,-0.008734723,0.009101736,-0.012122602,-0.008007319,-0.0112408195,-0.00739244,-0.0068084076,-0.0079832105,-0.001226337,0.013836729,0.011052745,0.0029330158,-0.004388698,0.0106707765,0.00707733,0.010747857,0.01477173,0.01727832,0.017687641,-0.0018129344,0.012671605,0.00013545652,0.0041035786,-0.01580646,-0.013656024,0.0021274404,-0.007420355,0.01332357,0.034183256,-0.004369048,0.0005694705,-0.0027547292,0.009580759,0.0044138352,-0.017712489,-0.006630596,-0.011797678,-0.020825198,0.011437832,0.00305501,0.018090904,0.0068399375,0.014112265,0.013291246,0.01279472,-0.026837464,0.002099351,-0.0039007738,0.006403815,0.008512408,0.0110592535,-0.007310302,-0.007204764,-0.0095527265,-0.009918629,-0.008896898,-0.0021707413,0.0100843,-0.003404929,-0.013368852,0.023566308,0.015571148,-0.010242897,0.0066028438,-0.004927772,0.01591856,-0.00091981713,0.013077372,0.007952566,-0.009052039,-0.0024599638,0.014517231,-0.017825663,0.00013706698,0.0068820277,-0.009558753,-0.024985354,-0.010581073,-0.022470053,-0.012132545,0.0048101265,0.0123855965,-0.007517451,0.0027984523,-0.0016456346,-0.0083796475,0.0044523976,0.0054897177,-0.015895834,-0.011130858,0.0018554617,0.0052394248,0.019339787,0.014360072,-0.02713021,-0.008611902,-0.010884848,-0.011582987,0.010308884,0.0074246875,-0.012986539,-0.01894838,-0.0075620865,0.0024605205,-0.009587067,-0.007835473,-0.009038963,-0.007414944,0.002032982,-0.016806582,0.020058984,0.011867411,0.0042779814,-0.012564435,0.00661149,0.0006285754,-0.0055374717,0.0026223504,0.013439254,0.020298963,0.012376352]
        # emb = emb.tolist()

        sql = f"""
        select md.team_id, md.dataset_id, md.collection_id, md.vector <=> '{emb}' as d
            from  modeldata md
            where md.vector <=> '{emb}' > 0.9
            order by d desc
            limit 10
        
        """
        # print(sql)
        data = conn.select_many(sql)
        print(data)


# t()
